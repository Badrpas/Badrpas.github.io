import{$}from"./index.988ce49e.js";const codeBlocks=[...(()=>{const t=localStorage.getItem("code_blocks");return t?JSON.parse(t):[]})()],save=()=>{localStorage.setItem("code_blocks",JSON.stringify(codeBlocks))},init=(data,updateData)=>{const evals=[],updateCodeBlocks=()=>{codeBlocks.splice(0,codeBlocks.length);for(const t of evals)codeBlocks.push(t.val());save()},$evals=$("#evals");for(const t of codeBlocks)addEval(t);const $btn=$("#add-eval");$btn.on("click",()=>{addEval(),updateCodeBlocks()});function addEval(text="const a=123;"){const $container=$("<div>"),$eval=$("<textarea>").val(text);$container.append($eval),evals.push($eval),$evals.prepend($container);const run=()=>{eval($eval.val()),updateData()};$eval.on("input",updateCodeBlocks),$eval.on("keydown",t=>{t.which===13&&t.ctrlKey&&run()});const $run=$("<button>").html("Run").addClass("run");$container.append($run),$run.on("click",run);const $del=$("<button>").html("X").addClass("del");$container.append($del),$del.on("click",()=>{const t=evals.indexOf($eval);evals.splice(t,1),updateCodeBlocks(),$eval.remove()})}},data={buy:0,even:0,post:0,profit:0,multiplier:1},history=[],cacheData=()=>{localStorage.setItem("data",JSON.stringify(data)),localStorage.setItem("history",JSON.stringify(history))},restoreCache=()=>{const t=localStorage.getItem("data");t&&Object.assign(data,JSON.parse(t));const a=localStorage.getItem("history");a&&history.push(...JSON.parse(a))},updateValues=()=>{Object.entries(data).forEach(([a,o])=>{$(`#${a}`).val(o.toFixed(2)).html(o.toFixed(2))});const t=[];for(let a=0;a<history.length;a++)Object.entries(data).every(([n,r])=>history[a][n]===r)&&t.push(a);for(;t.length;){const a=t.pop();console.log("rm",a),history.splice(a,1)}history.push({...data}),renderHistory(),cacheData()};function renderHistory(){$("#history").empty();const t=["buy","even","post","profit","multiplier","totalprofit"];for(const o of history){const n=$("<tr>").html(t.map(s=>{var c;return $("<td>").html(((c=o[s])==null?void 0:c.toFixed(2))||"??")})),r=$("<button>").html("[x]");n.append(r),r.on("click",()=>{const s=history.indexOf(o);history.splice(s,1),cacheData(),renderHistory()}),$("#history").prepend(n)}const a=$("<tr>").html(t.map(o=>$("<th>").html(o)));$("#history").prepend(a)}const readVal=e=>{e instanceof $||(e=$(e));const raw=e.val()||"0";let val=raw.replace(/ÑŽ/g,".");const number=Number(val);if(isNaN(number))try{const evaled=eval(val);return+evaled}catch(t){console.error(t)}return number},updateProfit=()=>{data.profit=data.post*.95-data.buy,data.totalprofit=data.profit*data.multiplier};restoreCache();updateValues();$('[name="calc"] #buy').on("change",t=>{data.buy=readVal(t.currentTarget),data.even=data.buy/.95,data.post=data.even*1.05,updateProfit(),updateValues()});$('[name="calc"] #even').on("change",t=>{data.even=readVal(t.currentTarget),data.buy=data.even*.95,data.post=data.even*1.05,updateProfit(),updateValues()});$('[name="calc"] #post').on("change",t=>{data.post=readVal(t.currentTarget),updateProfit(),updateValues()});$('[name="calc"] #multiplier').on("change",t=>{data.multiplier=readVal(t.currentTarget),updateProfit(),updateValues()});init(data,()=>{updateProfit(),updateValues()});
